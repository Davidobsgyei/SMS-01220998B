<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.chart.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<TabPane fx:id="mainTabPane" styleClass="dashboard-tabpane" stylesheets="@../css/style.css" xmlns="http://javafx.com/javafx/17.0.12" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.studentmanagement.ui.StudentsController">
    <tabs>
        <Tab closable="false" onSelectionChanged="#updateDashboard" text="Student Dashboard">
            <ScrollPane fitToWidth="true" styleClass="transparent-scroll">
                <VBox spacing="25" styleClass="dashboard-container">
                    <Label styleClass="view-header" text="System Overview" />

                    <HBox spacing="15">
                        <Button onAction="#goHome" styleClass="btn-secondary" text="ðŸ  Back to Home" />
                        <Button onAction="#navToManagement" styleClass="btn-primary" text="Manage Students" />
                        <Button fx:id="refreshBtn" onAction="#handleRefresh" styleClass="btn-refresh" text="ðŸ”„ Refresh Data" />
                        <Button fx:id="btnReports" mnemonicParsing="false" onAction="#handleOpenReports" prefHeight="40.0" prefWidth="150.0" style="-fx-background-color: #2c3e50; -fx-text-fill: white; -fx-font-weight: bold;" text="View Reports">
                            <graphic>
                            </graphic>
                        </Button>
                    </HBox>

                    <FlowPane hgap="20" vgap="20">
                        <VBox alignment="CENTER" styleClass="stat-card">
                            <Label styleClass="stat-label-small" text="Total Students" />
                            <Label fx:id="totalCountLabel" styleClass="stat-value" text="0" />
                        </VBox>
                        <VBox alignment="CENTER" styleClass="stat-card, active-card">
                            <Label styleClass="stat-label-small" text="Active Students" />
                            <Label fx:id="activeCountLabel" styleClass="stat-value" text="0" />
                        </VBox>
                        <VBox alignment="CENTER" styleClass="stat-card, inactive-card">
                            <Label styleClass="stat-label-small" text="Inactive Students" />
                            <Label fx:id="inactiveCountLabel" styleClass="stat-value" text="0" />
                        </VBox>
                        <VBox alignment="CENTER" styleClass="stat-card, gpa-card">
                            <Label styleClass="stat-label-small" text="Average GPA" />
                            <Label fx:id="avgGpaLabel" styleClass="stat-value" text="0.00" />
                        </VBox>
                    </FlowPane>

                    <Separator />

                    <VBox alignment="CENTER" spacing="10" styleClass="stat-card">
                        <Label styleClass="editor-title" text="Performance Distribution" />
                        <PieChart fx:id="gpaChart" legendSide="BOTTOM" prefHeight="350" />
                    </VBox>
                </VBox>
            </ScrollPane>
        </Tab>

        <Tab closable="false" text="Student Management">
            <BorderPane styleClass="management-root">
                <top>
                    <HBox spacing="10" styleClass="management-toolbar">
                        <Button onAction="#goHome" styleClass="btn-secondary" text="ðŸ  Home" />
                        <Separator orientation="VERTICAL" />
                        <TextField fx:id="searchField" onKeyReleased="#handleSearch" promptText="Search ID or Name" styleClass="modern-search" HBox.hgrow="ALWAYS" />
                    </HBox>
                </top>
                <center>
                    <VBox spacing="10" style="-fx-padding: 15;">
                        <TableView fx:id="studentTable" styleClass="modern-table" VBox.vgrow="ALWAYS">
                            <columns>
                                <TableColumn fx:id="colId" prefWidth="80.0" text="ID" />
                                <TableColumn fx:id="colName" prefWidth="150.0" text="Full Name" />
                                <TableColumn fx:id="colEmail" prefWidth="150.0" text="Email" />
                                <TableColumn fx:id="colLevel" prefWidth="70.0" text="Level" />
                                <TableColumn fx:id="colGpa" prefWidth="70.0" text="GPA" />
                                <TableColumn fx:id="colPhone" prefWidth="120.0" text="Phone" />
                                <TableColumn fx:id="colProgramme" prefWidth="120.0" text="Programme" />
                                <TableColumn fx:id="colDate" prefWidth="100.0" text="Date Added" />
                                <TableColumn fx:id="colStatus" prefWidth="120.0" text="Status" />
                            </columns>
                            <placeholder>
                                <Label style="-fx-text-fill: #95a5a6; -fx-font-size: 16;" text="No Student Records Found" />
                            </placeholder>
                            <columnResizePolicy>
                                <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                            </columnResizePolicy>
                        </TableView>
                    </VBox>
                </center>
                <right>
                    <VBox spacing="15" styleClass="editor-pane">
                        <Label styleClass="editor-title" text="STUDENT EDITOR" />
                        <TextField fx:id="idInput" promptText="Student ID" styleClass="editor-input" />
                        <TextField fx:id="nameInput" promptText="Full Name" styleClass="editor-input" />
                        <TextField fx:id="gpaInput" promptText="Current GPA" styleClass="editor-input" />
                        <TextField fx:id="phoneInput" promptText="Phone Number" styleClass="editor-input" />
                        <VBox spacing="8" style="-fx-padding: 10 0 0 0;">
                            <Button maxWidth="Infinity" onAction="#handleAddStudent" styleClass="btn-success" text="Add Student" />
                            <Button maxWidth="Infinity" onAction="#handleUpdate" styleClass="btn-primary" text="Update Record" />
                            <Button maxWidth="Infinity" onAction="#handleDelete" styleClass="btn-danger" text="Delete" />

                        </VBox>

                        <Separator style="-fx-padding: 10 0;" />
                        <Button maxWidth="Infinity" onAction="#handleImportCSV" styleClass="btn-outline" text="Import CSV" />
                        <Button maxWidth="Infinity" onAction="#handleExportCSV" styleClass="btn-outline" text="Export CSV" />
                    </VBox>
                </right>
            </BorderPane>
        </Tab>
    </tabs>
</TabPane>
